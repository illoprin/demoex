# üçΩÔ∏è –£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–∏–∫–æ–≤"

–ü—Ä–æ—Å—Ç–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–∏–∫–æ–≤ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ (—É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è —ç–∫–∑–∞–º–µ–Ω–∞)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã Docker –∏ Docker Compose
2. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
docker compose up -d
```

4. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: [http://localhost](http://localhost)

## üê≥ Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–µ

–°–µ—Ä–≤–∏—Å—ã:

- **nginx**: –í–µ–±-—Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 80)
- **php**: –û–±—Ä–∞–±–æ—Ç–∫–∞ PHP-–∫–æ–¥–∞
- **mysql**: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Ä—Ç 3306)

## üìå C—Ç—Ä–∞–Ω–∏—Ü—ã

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** (`/pages/login.php`)

   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è
   - –ó–∞–ø–∏—Å—å –≤ —Å–µ—Å—Å–∏—é

2. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏** (`/pages/create_order.php`)

   - POST-–∑–∞–ø—Ä–æ—Å —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
   - –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

3. **–ú–æ–∏ –∑–∞—è–≤–∫–∏** (`/pages/orders.php`)

   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞—è–≤–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

4. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** (`/pages/admin/orders.php`)
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ (`/pages/admin/change_status.php`)

## üìä –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 1. –¢–∞–±–ª–∏—Ü–∞ `roles` (–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

| id  | name  |
| --- | ----- |
| 1   | user  |
| 2   | admin |

- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)

### 2. –¢–∞–±–ª–∏—Ü–∞ `users` (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

| id  | role_id | first_name | last_name | phone        | email             | login  | password (hash) |
| --- | ------- | ---------- | --------- | ------------ | ----------------- | ------ | --------------- |
| 1   | 1       | –ò–≤–∞–Ω       | –ò–≤–∞–Ω–æ–≤    | +79991112233 | ivan@example.com  | ivanov | $2y$10$...      |
| 2   | 2       | –ê–¥–º–∏–Ω      | –ê–¥–º–∏–Ω–æ–≤   | +79994445566 | admin@example.com | admin  | $2y$10$...      |

- –°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö —Ä–æ–ª–∏
- –ü–æ–ª—è `email` –∏ `login` —É–Ω–∏–∫–∞–ª—å–Ω—ã

### 3. –¢–∞–±–ª–∏—Ü–∞ `statuses` (–°—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫)

| id  | name                     |
| --- | ------------------------ |
| 1   | pending (–æ–∂–∏–¥–∞–Ω–∏–µ)       |
| 2   | confirmed (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ) |
| 3   | rejected (–æ—Ç–∫–ª–æ–Ω–µ–Ω–æ)     |

### 4. –¢–∞–±–ª–∏—Ü–∞ `bookings` (–ó–∞—è–≤–∫–∏ –Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

| id  | user_id | booking_date | booking_time | guests_count | contact_phone | status_id | created_at          |
| --- | ------- | ------------ | ------------ | ------------ | ------------- | --------- | ------------------- |
| 1   | 1       | 2023-12-25   | 19:30:00     | 4            | +79991112233  | 1         | 2023-12-20 10:00:00 |

- –°–≤—è–∑–∞–Ω–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –≤–Ω–µ—à–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏

## üîê –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–ø—Å–µ–≤–¥–æ–∫–æ–¥)

```php
// –ü—Ä–∏–º–µ—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
session_start();

function login($login, $password) {
    // 1. –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    $user = db_query("SELECT * FROM users WHERE login = ?", [$login]);

    // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å
    if ($user && password_verify($password, $user['password'])) {
        $_SESSION['user_id'] = $user['id'];
        $_SESSION['role_id'] = $user['role_id'];
        return true;
    }
    return false;
}
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ó–∞—â–∏—Ç–∞ –æ—Ç XSS**:

```php
// –í—Å–µ –≤—ã–≤–æ–¥—ã –¥–∞–Ω–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è
echo htmlspecialchars($user_input, ENT_QUOTES, 'UTF-8');
```

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞—è–≤–æ–∫**:

```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
function validateBooking($data) {
    $errors = [];
    if (empty($data['booking_date'])) $errors[] = "–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É";
    if ($data['guests_count'] < 1) $errors[] = "–ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π";
    // ... –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    return $errors;
}
```

3. **PDO –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î**:

```php
// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
$stmt = $pdo->prepare("SELECT * FROM users WHERE login = ?");
$stmt->execute([$login]);
```
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î (–∏–∑ `docker-compose.yml`):

- –õ–æ–≥–∏–Ω: `appuser`
- –ü–∞—Ä–æ–ª—å: `apppassword`
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `appdb`
